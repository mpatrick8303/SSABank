<!DOCTYPE html>
<html>
	<head>
	<meta charset="ISO-8859-1">
	<title>SSA Bank</title>
	</head>
	<body>
		<header>
			<h1>SSA-Bank</h1>
			<menu id="menu">
				<ul>
					<li id="addCust">Add Customers</li>
					
					
				</ul>
			</menu>
		</header>
		<section id="customer-list">
			<ul id ="ul-c">
			
			</ul>
			
			
		</section>	
		
		<section  id="customer">
			<div class="custClass"></div>
			<button id="show-accounts">Show Accounts</button>
			<button id="updateCust">Update Customer</button>
		</section>
		
		<section id="accounts">
			<ul id="ul-a">
			
			</ul>
			<button id="addAccount">Add Account</button>
			<button id = "accountT">Transfer</button>
			
		</section>
		
		<section class="hidden" id="account">
			<div class="accClass"></div><br>
			
			<div id = wdt>
			<input id="textW" type="text">
			<button  id = "accountW">Withdraw</button>
			
			<input id="textD" type="text">
			<button id = "accountD">Deposit</button>
			
			
			<button id = "accountTransferFromAccount">Transfer</button>
			
			</div>
			
			<button id="updateAccount">Update Account</button>
			
		</section>
		
		<section id="addCustForm">
		
			<form>
				First Name<input id="fNameAdd" type="text">
				Last Name<input id="lNameAdd" type="text">
				
			</form>
			
			<button id="submitAddC">Add this BITCH</button>
		
		</section>
		
		<section id="updateCustForm">
		
			<form>
				First Name<input id="fNameUpdate" type="text">
				Last Name<input id="lNameUpdate" type="text">
				
			</form>
			
				<button id="submitUpdateC">Update this BITCH</button>
		</section>
		
		<section id="addAccountForm">
		
			<form>
				Type of Account<input id="TypeAdd" type="text">
				Balance<input id="BalanceAdd" type="text">
				
				
			</form>
			
				<button id="submitAddA">Add this BITCH</button>
		
		</section>
		
		<section id="updateAccountForm">
		
			
			<form>
				Customer ID<input id="CustomerUpdate" type="text">
				Type of Account<input id="TypeUpdate" type="text">				
				
	
			</form>
			
				<button id="submitUpdateA">Update this BITCH</button>

		</section>
		
		<section id="transfer">
			<form>
				Account ID #1<input id="accountOne" type="text">
				Transfer Amount<input id="tAmount" type="text">
				Account ID #2<input id="accountTwo" type="text">
			</form>
			
			<button id="submitTransfer">Transfer</button>
			
		</section>
		
		<section id="transferFromAccount">
			<p id = "accountOneF">
			<form>
				<input id="tAmountF" type="text">
				<p id = "accountTwoF"> to </p>
				Account ID #2<input id="accountTwo" type="text">
			</form>
			
			<button id="submitTransfer">Transfer</button>
			
		</section>
		
		
		<script src="/jquery-3.1.0.min.js"></script>
		<script type="text/javascript">
			var cusID = null;
			var accID = null;
			var accBalance = null;
			$(document).ready(function()
			{
				$.getJSON("ssa-bank/customers",customers);
				
			});
			function customers(response)
			{
				for(let i = 0; i<response.length;i++)
				{
					$('#ul-c').append('<li id=\''+response[i].id+'\'>' + response[i].id + " " + response[i].firstName + " " + response[i].lastName  + '</li>')
					
					
				}
				
				$('#customer-list').show()
				$('#customer').hide()
				$('#accounts').hide()
				$('#account').hide()
				$('#addCustForm').hide()
				$('#updateCustForm').hide()
				$('#addAccountForm').hide()
				$('#updateAccountForm').hide()
				$('#transfer').hide()
				$('#transferFromAccount').hide()
				
				
			}
			
			function customersClear()
			{
				$('#ul-c').empty()
			}
			
			
			$('#ul-c').click(function(evt)
			{
				cusID = evt.target.id
				console.log(cusID)
				$('.custClass').empty()
				$.getJSON("ssa-bank/customers/" + $(evt.target).attr('id'), customer)
				

			});
			function customer(response)
			{
				$('.custClass').attr('id',response.id).text(response.id + " " + response.firstName + " " + response.lastName)

				$('#customer-list').hide()
				$('#customer').show()
			}
			
			$('#addCust').click(function(evt)
			{
				$('#addCustForm').show()
				$('#customer-list').hide()
				$('#customer').hide()
				$('#accounts').hide()
				$('#wdt').hide()
				$('#account').hide()
				
			});
			
			$('#submitAddC').click(function(evt)
			{
				$('#addCustForm').hide()
				$('#customer-list').show()
				sendAdd();
        		location.reload()
				
			});
			
		
			function sendAdd() 
			{
				
				console.log(document.getElementById("fNameAdd").value)
				console.log(document.getElementById("lNameAdd").value)
				
		        $.ajax
		        ({
		            type: "POST",
		            url: "ssa-bank/customers",
		            dataType: "json",
		            data: {"firstName": document.getElementById("fNameAdd").value, "lastName": document.getElementById("lNameAdd").value}
		        })
		 
				
			}
			
			$('#updateCust').click(function(evt)
			{
				$('#updateCustForm').show()
				$('#addCustForm').hide()
				$('#customer-list').hide()
				$('#customer').hide()
				$('#accounts').hide()
				$('#wdt').hide()
				$('#account').hide()	
				
				console.log(cusID)
				
				
			});
			
			$('#submitUpdateC').click(function(evt)
					{
						
						sendUpdate();
						location.reload()
					});
					
				
					function sendUpdate()
					{	
				        $.ajax
				        ({
				            type: "PUT",
				            url: "ssa-bank/customers/" + cusID,
				            dataType: "json",
				            data: {"firstName": document.getElementById("fNameUpdate").value, "lastName": document.getElementById("lNameUpdate").value}
				        })
						
					}
			
			
			
			$('#show-accounts').click(function(evt)
			{
				$('#customer').hide()
				$('#accounts').show()
				$('#acounts')
				console.log(document.getElementsByClassName('custClass')[0].id)
				$.getJSON("ssa-bank/customers/"+ document.getElementsByClassName('custClass')[0].id + "/accounts" , accounts)
						

			});
			function accounts(response)
			{
				
				console.log(response.length)
				console.log(response[0].id)
				
				
				
				
				for(let i = 0; i<response.length;i++)
				{
				
					$('#ul-a').append('<li id=\''+response[i].id+'\'>' + response[i].id + " " + response[i].customer.id + " " + response[i].type + " " + response[i].balance  + '</li>')
					
				}
				
				
			}
			
			$('#ul-a').click(function(evt)
			{
				accID = evt.target.id
				console.log(accID)
				console.log(document.getElementsByClassName('custClass')[0].id)
				$('.accClass').empty()
				$.getJSON("ssa-bank/customers/" + document.getElementsByClassName('custClass')[0].id  + "/accounts/" + $(evt.target).attr('id') + "/detail", account)
						

			});
			function account(response)
			{
				accBalance = response.balance
				$('.accClass').attr('id',response.id).text(response.id + " " + response.customer.id + " " + response.type + " " + response.balance)

				$('#accounts').hide()
				$('#account').show()

			}
			
			$('#addAccount').click(function(evt)
			{
				$('#addAccountForm').show()
			});
			
			
			$('#submitAddA').click(function(evt)
			{
						
				sendAddAccount();
				location.reload()
						
			});
					
			function sendAddAccount() 
			{
				console.log(document.getElementsByClassName('custClass')[0].id)
				console.log(document.getElementById("TypeAdd").value)
				console.log(document.getElementById("BalanceAdd").value)
						
						
		         $.ajax
	      		({
          			 type: "POST",
           			 url: "ssa-bank/customers/accounts",
		           	 dataType: "json",
		       		 data: {"custID": document.getElementsByClassName('custClass')[0].id, "Type": document.getElementById("TypeAdd").value, "Balance": document.getElementById("BalanceAdd").value}
		   		})
		        		
	     		customersClear()
        		customers()
				}
					
			$('#updateAccount').click(function(evt)
			{
					$('#updateAccountForm').show()
					$('#wdt').hide()
					$('#updateAccount').hide()
					
					
											
					
			});
			
			
							
			$('#submitUpdateA').click(function(evt)
			{
										
				sendUpdateAccount();
				location.reload()
				
				
			});
									
			function sendUpdateAccount() 
			{
				
										
										
		        $.ajax
	       		({
     				type: "PUT",
     				url: "ssa-bank/customers/" + cusID + "/accounts/" + accID,
					dataType: "json",
					data: {"Customer": document.getElementById("CustomerUpdate").value, "Type": document.getElementById("TypeUpdate").value, "Balance": accBalance }
				})
						        		

			}
			
			$('#accountW').click(function(evt)
					{
												
						withdrawAccount();
						location.reoload()
						
						
					});
											
					function withdrawAccount() 
					{
						
												
												
				        $.ajax
			       		({
		     				type: "PUT",
		     				url: "ssa-bank/customers/" + cusID + "/accounts/" + accID + "/withdraw",
							dataType: "json",
							data: {"withdraw": document.getElementById("textW").value}
						})
								        		

					}
					
			$('#accountD').click(function(evt)
			{
														
				depositAccount();
				location.reload()
								
								
			});
													
			function depositAccount() 
			{
								
														
														
		        $.ajax
	       		({
					type: "PUT",
					url: "ssa-bank/customers/" + cusID + "/accounts/" + accID + "/deposit",
					dataType: "json",
					data: {"deposit": document.getElementById("textD").value}
				})
										        		

			}
			
			$('#accountT').click(function(evt)
			{
				$('#accounts').hide()
				$('#transfer').show()
			});
			
			$('#submitTransfer').click(function(evt)
			{
																
				transferAccount();
				location.reload()
										
										
			});
															
			function transferAccount() 
			{
										
																
																
	  	      $.ajax
	          ({
			  	type: "PUT",
				url: "ssa-bank/customers/" + cusID + "/accounts/" + accID + "/transfer",
				dataType: "json",
				data: {"accountOne": document.getElementById("accountOne").value, "transferAmount": document.getElementById("tAmount").value, "accountTwo": document.getElementById("accountTwo").value }
			  })
												        		

			}	
			
			$('#accountTransferFromAccount').click(function(evt)
			{
						$('#account').hide()
						$('#transferFromAccount').show()
						
						$('#accountOneF').append("How Much Would you like to transfer from account ID " + accID)	
			});
					
			$('#submitTransfer').click(function(evt)
			{
																		
				transferAccountF()
				location.reload()
												
												
			});
																	
			function transferAccountF() 
			{
						
											
																		
																		
				$.ajax
			    ({
					type: "PUT",
					url: "ssa-bank/customers/" + cusID + "/accounts/" + accID + "/transferFromAccount",
					dataType: "json",
					data: {"transferAmount": document.getElementById("tAmountF").value, "accountTwo": document.getElementById("accountTwoF").value }
				})
														        		

					}	

					
			
	
		
		</script>
	</body>
</html>